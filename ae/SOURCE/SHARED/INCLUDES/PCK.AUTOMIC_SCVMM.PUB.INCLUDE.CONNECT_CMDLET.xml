<?xml version="1.0" encoding="ISO-8859-15" standalone="no"?><uc-export clientvers="11.0.0">
<JOBI name="PCK.AUTOMIC_SCVMM.PUB.INCLUDE.CONNECT_CMDLET">
<HEADER state="1">
<Title>Connect to VMM server</Title>
<ArchiveKey1/>
<ArchiveKey2/>
<OH_SubType/>
</HEADER>
<SCRIPT mode="1" state="1">
<MSCRI><![CDATA[! Decrypt Password
: INC PCK.ITPA_SHARED.PUB.INCLUDE.ATTACH
: SET &UC4RB_ENCRYPTED_PASSWORD_TMP# = "&UC4RB_VMM_PASSWORD#"
: INC PCK.ITPA_SHARED.PRV.INCLUDE.DECRYPT_PASSWORD

! Create PSCredential object
 $securepassword = ConvertTo-SecureString $UC4_DECRYPTED_PWD -AsPlainText -Force
 $servercreds = New-Object System.Management.Automation.PSCredential ('&UC4RB_VMM_ESC_USER#', $securepassword)

! logging connect command
 Write-Host "INFO:" &UC4RB_VMM_CONNECT_CMDLET#

! Connect to VMM Server
  try{
      $vmmserver = &UC4RB_VMM_CONNECT_CMDLET# -Credential $servercreds
      Write-Host "INFO: Successfully connected to VMM Server"
  }catch{
      Write-Host "ERROR: Error connecting VMM Server."
      Write-Host "ERROR: $($error[0].Exception.Message)"
      __uc_return(1)
  }

]]></MSCRI>
</SCRIPT>
<DOCU_Docu state="1" type="text">
<DOC><![CDATA[Initializes the PowerShell environment to execute our script and PowerCLI cmdlets. Following is initialized:
* sets PowerCLI to path env variable and calls script to initialize PowerCLI environment
* initializes variable $ErrorActionPreference and $error for Error handling and processing.

This include can be only used in Job's Process tab.
It can be used for Windows PowerShell environment.
]]></DOC>
</DOCU_Docu>
</JOBI>
</uc-export>